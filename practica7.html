
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Pr&aacute;ctica 7: Respuesta en frecuencia y Simulink</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-12-11"><meta name="DC.source" content="practica7.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Pr&aacute;ctica 7: Respuesta en frecuencia y Simulink</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Datos generales:</a></li><li><a href="#3">Objetivos:</a></li><li><a href="#5">Introducci&oacute;n</a></li><li><a href="#6">Simulaci&oacute;n en c&oacute;digo</a></li><li><a href="#13">Simulaci&oacute;n con simulink Ejercicio a)</a></li><li><a href="#16">Simulaci&oacute;n con simulink Ejercicio b)</a></li></ul></div><h2 id="1">Datos generales:</h2><p>Autor: Marmolejo Mart&iacute;nez Hamlet Jorge</p><p>Grupo: 2TV2</p><p>Profesor: Dr. Rafael Martinez Martinez</p><h2 id="3">Objetivos:</h2><div><ul><li>Conocer la representaci&oacute;n de un sistema LTI en Matlab</li><li>Manipulaci&oacute;n de instrucciones en MATLAB</li><li>Mostrar las gr&aacute;ficas bode para funciones de tranferencia</li><li>Conocer la respuesta en frecuencia de un sistema</li><li>Conocer los usos b&aacute;sicos de Simulink para resolver sistemas diferenciales</li></ul></div><h2 id="5">Introducci&oacute;n</h2><p>En esta pr&aacute;ctica se mostrar&aacute; el procedimiento para: * Conocer la respuesta en frecuencia de un sistema LTI y su gr&aacute;fica bode * Usar las herramientas de Simulink para resolver sistemas diferenciales</p><h2 id="6">Simulaci&oacute;n en c&oacute;digo</h2><p>El siguiente circuito mostrado en la  imagen <a href="RLC_schematic.png">RLC_schematic.png</a></p><p>Para circuitos RLC tenemos que: <img src="practica7_eq00820247378162796534.png" alt="$$v_{i}(t)=v_{r}(t)+v_{c}(t)+v_{l}(t)$"></p><p>Para la resistencia el  voltaje se define como: <img src="practica7_eq01279406462045463862.png" alt="$$v_{r}(t)=Ri(t)$"></p><p>Para el inductor se puede definir el voltaje como <img src="practica7_eq07466895216006194033.png" alt="$$v_{l}(t)=L\frac{\mathrm{d} i }{\mathrm{d} t}$"></p><p>Para el capacitor se define el voltaje como <img src="practica7_eq08044169188686264708.png" alt="$$v_{c}(t)=\frac{1}{c}\int_{0}^{t} i(t)dt$"></p><p>Y tenemos que <img src="practica7_eq16934291584034375071.png" alt="$$i(t)=C\frac{\mathrm{d} v_{o}(t)}{\mathrm{d} t}$"></p><p>Aplicando el teorema fundamental del c&aacute;lculo</p><p>Ahora sustituimos en la ecuaci&oacute;n de LCK</p><p><img src="practica7_eq03786569824266636611.png" alt="$$v_{i}(t)=Ri(t)+\frac{1}{c}\int_{0}^{t} i(t)dt+L\frac{\mathrm{d} i }{\mathrm{d} t}$"></p><p>Reemplazamos a <img src="practica7_eq15966632775778756210.png" alt="$$i(t)$"></p><p><img src="practica7_eq16918647588581563697.png" alt="$$C\dot{v_{i}(t)}=L\frac{\mathrm{d^{2}}v_{o}(t) }{\mathrm{d} t^{2}}+R\frac{\mathrm{d} v_{o}(t)}{\mathrm{d} t}+\frac{1}{L}v_{o}(t)$"></p><p>Y despejamos a C <img src="practica7_eq10000776724014022635.png" alt="$$\dot{v_{i}(t)}=\frac{L}{C}\frac{\mathrm{d^{2}}v_{o}(t) }{\mathrm{d} t^{2}}+\frac{R}{C}\frac{\mathrm{d} v_{o}(t)}{\mathrm{d} t}+\frac{1}{LC}v_{o}(t)$"></p><p>Ahora con la funci&oacute;n obtenemos la transformada de laplace para conocer la funci&oacute;n de transferencia *Aplicamos transformada de Laplace a la ecuaci&oacute;n de entrada y nos queda <img src="practica7_eq07626388512989010771.png" alt="$$s^{2}+\frac{R}{L}s+\frac{1}{LC}$"> *Aplicamos ahora la transformada de laplace a la salida <img src="practica7_eq17440176598318261795.png" alt="$$\frac{R}{L}s$"> Ahora con la definici&oacute;n de la funci&oacute;n de transferencia <img src="practica7_eq04017043688712751359.png" alt="$$H(s)=\frac{Y(s)}{X(s)}$"> Sustituimos <img src="practica7_eq12623434849954247786.png" alt="$$H(s)=\frac{\frac{R}{L}s}{s^{2}+\frac{R}{L}s+\frac{1}{LC}}$"></p><p>Ahora definimos <img src="practica7_eq05904075908646909058.png" alt="$$L=1H,C=100\mu F y R=10K\Omega$"></p><pre class="codeinput"> syms <span class="string">t</span>
 L=1;
 C=100^(-6);
 R=10^(3);
</pre><p>Una vez ya definidos formamos nuestra funci&oacute;n de transferencia</p><pre class="codeinput"> circuit_sys=tf([(R/L)],[1 (R/L) (1/L*C)])
</pre><pre class="codeoutput">
circuit_sys =
 
          1000
  --------------------
  s^2 + 1000 s + 1e-12
 
Continuous-time transfer function.

</pre><p>Ahora obtenemos la respuesta al impulso</p><pre class="codeinput"> figure
 impulse(circuit_sys)
 legend(<span class="string">'Respuesta al impulso'</span>)
</pre><img vspace="5" hspace="5" src="practica7_01.png" alt=""> <p>Ahora obtenemos la respuesta al escal&oacute;n</p><pre class="codeinput"> figure
 step(circuit_sys)
 legend(<span class="string">'Respuesta al escal&oacute;n'</span>)
</pre><img vspace="5" hspace="5" src="practica7_02.png" alt=""> <p>Definimos <img src="practica7_eq00453403513386305139.png" alt="$$w_{0}=\frac{1}{\sqrt{LC}}$">$</p><pre class="codeinput"> w0=1/sqrt(R*C);
</pre><p>Se muestran las gr&aacute;ficas de bode</p><pre class="codeinput"> figure
 hold <span class="string">on</span>

 <span class="keyword">for</span> m=0:6
    bode(tf([(R/L*(exp(-1*m)))],[1 (R/L*(exp(-1*m))) (1/L*(exp(-1*m))*C)]))
    pause(0.5)
    drawnow
 <span class="keyword">end</span>
 grid <span class="string">on</span>
 legend(<span class="string">'m=1'</span>,<span class="string">'m=1e-1'</span>,<span class="string">'m=1e-2'</span>,<span class="string">'m=1e-3'</span>,<span class="string">'m=1e-4'</span>,<span class="string">'m=1e-5'</span>,<span class="string">'m=1e-6'</span>)
 title(<span class="string">'Bode para la funci&oacute;n de transferencia'</span>)
 hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="practica7_03.png" alt=""> <h2 id="13">Simulaci&oacute;n con simulink Ejercicio a)</h2><p>Primero encontramos la soluci&oacute;n anal&iacute;tca mediante la transformada de laplace y la funci&oacute;n de transferencia</p><pre class="codeinput">syms <span class="string">t</span>
transformadaLaplace([6 5 1],[1],[1 0],[0 0],2*cos((4*t)-pi/3)*heaviside(t),10)
</pre><pre class="codeoutput"> 
APLICAMOS TRANSFORMADA DE LAPLACE y substituimos condiciones iniciales
 
                         2
6 Y(s) - s + 5 s Y(s) + s  Y(s) - 5

=
X(s)

 
SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA
 
                         2
6 Y(s) - s + 5 s Y(s) + s  Y(s) - 5

=
4 sqrt(3)      s
--------- + -------
  2          2
 s  + 16    s  + 16

 
DESPEJAMOS Y(s)
 
Y(s)=
    4 sqrt(3)      s
s + --------- + ------- + 5
      2          2
     s  + 16    s  + 16
---------------------------
         2
        s  + 5 s + 6

 
DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(s)
 
Y(s)=
sqrt(3)   29   4 sqrt(3)   47   2 sqrt(3)     / sqrt(3)    1 \    4
------- + --   --------- + --   --------- + s | ------- + -- | - --
   5      10       25      25       25        \    25     50 /   25
------------ - -------------- - -----------------------------------
    s + 2           s + 3                      2
                                              s  + 16

 
Aplicamos transformada inversa, asi la soluci&oacute;n es
 
y(t)=
sin(4 t)   cos(4 t)   sqrt(3) sin(4 t)             / sqrt(3)   29 \
-------- - -------- - ---------------- + exp(-2 t) | ------- + -- |
   25         50             50                    \    5      10 /

               / 4 sqrt(3)   47 \   sqrt(3) cos(4 t)
   - exp(-3 t) | --------- + -- | - ----------------
               \     25      25 /          25

 
Ahora encontramos la funci&oacute;n de transferencia del sistema
 
 
G(s) =
 
-((2*3^(1/2))/(25*(s^2 + 16)) + s/(50*(s^2 + 16)) - 4/(25*(s^2 + 16)) - (3^(1/2)/5 + 29/10)/(s + 2) + ((4*3^(1/2))/25 + 47/25)/(s + 3) + (3^(1/2)*s)/(25*(s^2 + 16)))/((4*3^(1/2))/(s^2 + 16) + s/(s^2 + 16))
 
                                  sqrt(3)   29   4 sqrt(3)   47
                                  ------- + --   --------- + --
  2 sqrt(3)         s         4      5      10       25      25   sqrt(3) s
  --------- + ------------ - -- - ------------ + -------------- + ---------
      #1           2         #1       s + 2           s + 3           #1
              50 (s  + 16)
- -------------------------------------------------------------------------
                             4 sqrt(3)      s
                             --------- + -------
                               2          2
                              s  + 16    s  + 16

where

              2
   #1 == 25 (s  + 16)


</pre><img vspace="5" hspace="5" src="practica7_04.png" alt=""> <p>Presentamos el resultado num&eacute;rico de la realizaci&oacute;n en simulink</p><pre class="codeinput">close <span class="string">all</span>
[a.Time,a.Data]
</pre><pre class="codeoutput">
ans =

         0    1.0000    1.0000
    0.0001    1.0003    1.0000
    0.0003    1.0021    1.0000
    0.0016    1.0108    1.0000
    0.0078    1.0538    0.9999
    0.0392    1.2584    0.9970
    0.1962    1.9316    0.9360
    0.3962    1.7178    0.7822
    0.5962    0.4619    0.5744
    0.7962   -1.0741    0.3166
    0.9962   -1.9586    0.0120
    1.1962   -1.6550   -0.3058
    1.3962   -0.3476   -0.5669
    1.5962    1.1707   -0.6904
    1.7962    1.9789   -0.6282
    1.9962    1.5867   -0.3983
    2.1962    0.2320   -0.0860
    2.3962   -1.2634    0.1919
    2.5962   -1.9924    0.3418
    2.7962   -1.5129    0.3363
    2.9962   -0.1157    0.2213
    3.1962    1.3517    0.0847
    3.3962    1.9992    0.0041
    3.5962    1.4339    0.0050
    3.7962   -0.0011    0.0525
    3.9962   -1.4355    0.0812
    4.1962   -1.9991    0.0410
    4.3962   -1.3501   -0.0667
    4.5962    0.1178   -0.1879
    4.7962    1.5143   -0.2487
    4.9962    1.9922   -0.2024
    5.1962    1.2617   -0.0612
    5.3962   -0.2342    0.1071
    5.5962   -1.5880    0.2171
    5.7962   -1.9786    0.2142
    5.9962   -1.1689    0.1070
    6.1962    0.3497   -0.0386
    6.3962    1.6563   -0.1382
    6.5962    1.9581   -0.1387
    6.7962    1.0722   -0.0484
    6.9962   -0.4641    0.0696
    7.1962   -1.7189    0.1372
    7.3962   -1.9310    0.1096
    7.5962   -0.9718    0.0025
    7.7962    0.5769   -0.1177
    7.9962    1.7756   -0.1747
    8.1962    1.8973   -0.1299
    8.3962    0.8681   -0.0062
    8.5962   -0.6877    0.1246
    8.7962   -1.8263    0.1854
    8.9962   -1.8572    0.1401
    9.1962   -0.7615    0.0157
    9.3962    0.7961   -0.1139
    9.5962    1.8708   -0.1719
    9.7962    1.8107   -0.1253
    9.9962    0.6522   -0.0040
   10.0000    0.6236   -0.0014

</pre><p>Ahora se presenta la soluci&oacute;n del sistema como se ve en un scope</p><pre class="codeinput">plot(a.time,a.Data)
legend(<span class="string">'entrada f(t)'</span>,<span class="string">'salida y(t)'</span>)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="practica7_05.png" alt=""> <h2 id="16">Simulaci&oacute;n con simulink Ejercicio b)</h2><p>Primero encontramos la soluci&oacute;n anal&iacute;tca mediante la transformada de laplace y la funci&oacute;n de transferencia</p><pre class="codeinput">syms <span class="string">t</span>
transformadaLaplace([6 5 1],[1],[1 0],[0 0],0*t,10)
</pre><pre class="codeoutput"> 
APLICAMOS TRANSFORMADA DE LAPLACE y substituimos condiciones iniciales
 
                         2
6 Y(s) - s + 5 s Y(s) + s  Y(s) - 5

=
X(s)

 
SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA
 
                         2
6 Y(s) - s + 5 s Y(s) + s  Y(s) - 5

=
0

 
DESPEJAMOS Y(s)
 
Y(s)=
    s + 5
------------
 2
s  + 5 s + 6

 
DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(s)
 
Y(s)=
  3       2
----- - -----
s + 2   s + 3

 
Aplicamos transformada inversa, asi la soluci&oacute;n es
 
y(t)=
exp(-2 t) 3 - exp(-3 t) 2

 
Ahora encontramos la funci&oacute;n de transferencia del sistema
 
 
G(s) =
 
Inf*(3/(s + 2) - 2/(s + 3))
 
/   3       2   \
| ----- - ----- | Inf
\ s + 2   s + 3 /

</pre><img vspace="5" hspace="5" src="practica7_06.png" alt=""> <p>Presentamos el resultado num&eacute;rico de la realizaci&oacute;n en simulink</p><pre class="codeinput">close <span class="string">all</span>
[b.Time,b.Data]
</pre><pre class="codeoutput">
ans =

         0         0    1.0000
    0.0000         0    1.0000
    0.0002         0    1.0000
    0.0012         0    1.0000
    0.0063         0    0.9999
    0.0314         0    0.9976
    0.1570         0    0.9421
    0.3570         0    0.7306
    0.5570         0    0.4271
    0.7570         0    0.1026
    0.9570         0   -0.1814
    1.1570         0   -0.3816
    1.3570         0   -0.4775
    1.5570         0   -0.4709
    1.7570         0   -0.3815
    1.9570         0   -0.2403
    2.1570         0   -0.0819
    2.3570         0    0.0624
    2.5570         0    0.1694
    2.7570         0    0.2268
    2.9570         0    0.2334
    3.1570         0    0.1972
    3.3570         0    0.1324
    3.5570         0    0.0557
    3.7570         0   -0.0170
    3.9570         0   -0.0735
    4.1570         0   -0.1066
    4.3570         0   -0.1148
    4.5570         0   -0.1010
    4.7570         0   -0.0717
    4.9570         0   -0.0349
    5.1570         0    0.0014
    5.3570         0    0.0309
    5.5570         0    0.0495
    5.7570         0    0.0560
    5.9570         0    0.0512
    6.1570         0    0.0382
    6.3570         0    0.0208
    6.5570         0    0.0028
    6.7570         0   -0.0124
    6.9570         0   -0.0227
    7.1570         0   -0.0270
    7.3570         0   -0.0258
    7.5570         0   -0.0202
    7.7570         0   -0.0120
    7.9570         0   -0.0031
    8.1570         0    0.0047
    8.3570         0    0.0102
    8.5570         0    0.0130
    8.7570         0    0.0129
    8.9570         0    0.0105
    9.1570         0    0.0067
    9.3570         0    0.0024
    9.5570         0   -0.0016
    9.7570         0   -0.0045
    9.9570         0   -0.0061
   10.0000         0   -0.0063

</pre><p>Ahora se presenta la soluci&oacute;n del sistema como se ve en un scope</p><pre class="codeinput">plot(b.time,b.Data)
legend(<span class="string">'entrada f(t)'</span>,<span class="string">'salida y(t)'</span>)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="practica7_07.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Práctica 7: Respuesta en frecuencia y Simulink
%% Datos generales:
% Autor:
% Marmolejo Martínez Hamlet Jorge
%
% Grupo: 2TV2 
%
% Profesor: Dr. Rafael Martinez Martinez
%%
%% Objetivos:
% * Conocer la representación de un sistema LTI en Matlab
% * Manipulación de instrucciones en MATLAB
% * Mostrar las gráficas bode para funciones de tranferencia
% * Conocer la respuesta en frecuencia de un sistema
% * Conocer los usos básicos de Simulink para resolver sistemas
% diferenciales
%%
%% Introducción
% En esta práctica se mostrará el procedimiento para:
% * Conocer la respuesta en frecuencia de un sistema LTI y su gráfica bode
% * Usar las herramientas de Simulink para resolver sistemas diferenciales
%% Simulación en código
% El siguiente circuito mostrado en la  imagen 
% <RLC_schematic.png>
%
% Para circuitos RLC tenemos que:
% $$v_{i}(t)=v_{r}(t)+v_{c}(t)+v_{l}(t)$
% 
% Para la resistencia el  voltaje se define como:
% $$v_{r}(t)=Ri(t)$
%
% Para el inductor se puede definir el voltaje como
% $$v_{l}(t)=L\frac{\mathrm{d} i }{\mathrm{d} t}$
%
% Para el capacitor se define el voltaje como
% $$v_{c}(t)=\frac{1}{c}\int_{0}^{t} i(t)dt$
%
% Y tenemos que
% $$i(t)=C\frac{\mathrm{d} v_{o}(t)}{\mathrm{d} t}$
%
% Aplicando el teorema fundamental del cálculo
%
% Ahora sustituimos en la ecuación de LCK
%
% $$v_{i}(t)=Ri(t)+\frac{1}{c}\int_{0}^{t} i(t)dt+L\frac{\mathrm{d} i }{\mathrm{d}
% t}$
%
% Reemplazamos a $$i(t)$
%
% $$C\dot{v_{i}(t)}=L\frac{\mathrm{d^{2}}v_{o}(t) }{\mathrm{d}
% t^{2}}+R\frac{\mathrm{d} v_{o}(t)}{\mathrm{d} t}+\frac{1}{L}v_{o}(t)$
%
% Y despejamos a C
% $$\dot{v_{i}(t)}=\frac{L}{C}\frac{\mathrm{d^{2}}v_{o}(t) }{\mathrm{d}
% t^{2}}+\frac{R}{C}\frac{\mathrm{d} v_{o}(t)}{\mathrm{d}
% t}+\frac{1}{LC}v_{o}(t)$
%
% Ahora con la función obtenemos la transformada de laplace para conocer la
% función de transferencia
% *Aplicamos transformada de Laplace a la ecuación de entrada y nos queda
% $$s^{2}+\frac{R}{L}s+\frac{1}{LC}$
% *Aplicamos ahora la transformada de laplace a la salida
% $$\frac{R}{L}s$
% Ahora con la definición de la función de transferencia 
% $$H(s)=\frac{Y(s)}{X(s)}$
% Sustituimos
% $$H(s)=\frac{\frac{R}{L}s}{s^{2}+\frac{R}{L}s+\frac{1}{LC}}$
%% 
% Ahora definimos $$L=1H,C=100\mu F y R=10K\Omega$
 syms t
 L=1;
 C=100^(-6);
 R=10^(3);
%%
% Una vez ya definidos formamos nuestra función de transferencia
 circuit_sys=tf([(R/L)],[1 (R/L) (1/L*C)])
%%
% Ahora obtenemos la respuesta al impulso
 figure
 impulse(circuit_sys)
 legend('Respuesta al impulso')
 %%
% Ahora obtenemos la respuesta al escalón
 figure
 step(circuit_sys)
 legend('Respuesta al escalón')
%%
% Definimos $$w_{0}=\frac{1}{\sqrt{LC}}$$
 w0=1/sqrt(R*C);
%%
% Se muestran las gráficas de bode 
 figure
 hold on

 for m=0:6
    bode(tf([(R/L*(exp(-1*m)))],[1 (R/L*(exp(-1*m))) (1/L*(exp(-1*m))*C)]))
    pause(0.5)
    drawnow
 end
 grid on
 legend('m=1','m=1e-1','m=1e-2','m=1e-3','m=1e-4','m=1e-5','m=1e-6')
 title('Bode para la función de transferencia')
 hold off
%% Simulación con simulink Ejercicio a)
% Primero encontramos la solución analítca mediante la transformada de
% laplace y la función de transferencia
syms t
transformadaLaplace([6 5 1],[1],[1 0],[0 0],2*cos((4*t)-pi/3)*heaviside(t),10)
%%
% Presentamos el resultado numérico de la realización en simulink
close all
[a.Time,a.Data]
%%
% Ahora se presenta la solución del sistema como se ve en un scope
plot(a.time,a.Data)
legend('entrada f(t)','salida y(t)')
grid on
%% Simulación con simulink Ejercicio b)
% Primero encontramos la solución analítca mediante la transformada de
% laplace y la función de transferencia
syms t
transformadaLaplace([6 5 1],[1],[1 0],[0 0],0*t,10)
%%
% Presentamos el resultado numérico de la realización en simulink
close all
[b.Time,b.Data]
%%
% Ahora se presenta la solución del sistema como se ve en un scope
plot(b.time,b.Data)
legend('entrada f(t)','salida y(t)')
grid on
##### SOURCE END #####
--></body></html>